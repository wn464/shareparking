<!doctype html>
<html lang="en">
<head>
	<title>个人中心</title>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
	<link rel="stylesheet" href="assets/vendor/bootstrap/css/bootstrap.min.css">
	<link rel="stylesheet" href="assets/vendor/font-awesome/css/font-awesome.min.css">
	<link rel="stylesheet" href="assets/vendor/linearicons/style.css">
	<link rel="stylesheet" href="assets/css/main.css">
	<link rel="stylesheet" href="assets/css/demo.css">
	<link href="assets/layui/css/layui.css" />
	<link rel="apple-touch-icon" sizes="76x76" href="assets/img/apple-icon.png">
	<link rel="icon" type="image/png" sizes="96x96" href="assets/img/favicon.png">
</head>
<body>
	<div id="app">
	<div id="wrapper">
		<nav class="navbar navbar-default navbar-fixed-top" id="toping"></nav>
	<!--侧边栏-->
		<div id="sidebar-nav" class="sidebar">
			<div class="sidebar-scroll">
				<nav>
					<ul class="nav" >
						<li><a href="index.html" class=""><i class="lnr lnr-home"></i> <span>共享车位主页</span></a></li>
						<li v-if="shabi==2"><a href="log.html" class=""><i class="lnr lnr-file-empty"></i> <span>日志管理</span></a></li>
						
						<li><a href="order.html" class=""><i class="lnr lnr-map"></i> <span>订单中心</span></a></li>
						<li><a href="car.html" class=""><i class="lnr lnr-map-marker"></i> <span>车位信息</span></a></li>
						<li><a href="member.html" class=""><i class="lnr lnr-users"></i> <span>用户管理</span></a></li>
						<li><a href="message.html" class=""><i class="lnr lnr-bookmark"></i> <span>用户车位审核</span></a></li>
						<li><a href="money.html" class=""><i class="lnr lnr-linearicons"></i> <span>财务统计</span></a></li>
						<li><a href="complain.html" class=""><i class="lnr lnr-chart-bars"></i> <span>投诉管理</span></a></li>
						<li><a href="user-change.html" class="active"><i class="lnr lnr-user"></i> <span>个人信息管理</span></a></li>
						<li v-if="shabi==2"><a href="authority.html" class=""><i class="lnr lnr-cog"></i><span>操作权限管理</span></a></li>
					</ul>
				</nav>
			</div>
		</div>
		<div class="main" >
			<div class="main-content">
				<div class="container-fluid">
					<div class="panel panel-profile">
						<div class="clearfix">
							<div class="profile-left">
								<div class="profile-header">
									<div class="overlay"></div>
									<div class="profile-main">
										<img src="assets/img/user-medium.png" class="img-circle" alt="Avatar">
							<!--账号名称--><h3 class="name"></h3>
										<span class="online-status status-available"> </span>
									</div>
									<div class="profile-stat">
										<div class="row">
											<div class="col-md-4 stat-item">
									<!--身份权限-->&nbsp;<span>{{authority.message}}</span>
											</div>
											<div class="col-md-4 stat-item">
										<!--性别-->&nbsp;<span>{{gender.name}}</span>
											</div>
											<div class="col-md-4 stat-item">
												&nbsp;<span>工号：<em>{{mes.username}}</em></span>
											</div>
										</div>
									</div>
								</div>
								<div class="profile-detail">
									<div class="profile-info">
										<h4 class="heading">基础信息</h4>
										<ul class="list-unstyled list-justify">
											<li>&nbsp;<span>&nbsp;</span></li>
											<li>姓名<span>{{mes.name}}</span></li>
											<li>手机号<span>{{mes.phonenumber}}</span></li>
											<li>邮箱 <span>{{mes.email}}</span></li>
										</ul>
									</div>
									<div class="profile-info">
										<h4 class="heading">Social</h4>
										<ul class="list-inline social-icons">
											<li><a href="#" class="facebook-bg"><i class="fa fa-facebook"></i></a></li>
											<li><a href="#" class="twitter-bg"><i class="fa fa-twitter"></i></a></li>
											<li><a href="#" class="google-plus-bg"><i class="fa fa-google-plus"></i></a></li>
											<li><a href="#" class="github-bg"><i class="fa fa-github"></i></a></li>
										</ul>
									</div>
								</div>
							</div>
							<div class="profile-right">
								<h4 class="heading"> &nbsp;个人信息管理</h4>
								<div class="awards">
									<div class="row" style="margin-left: 50px;">
										<div class="col-md-3 col-sm-6">
											<div class="award-item">
												<div class="hexagon">
													<span class="lnr lnr-sun award-icon"></span>
												</div>
												<span>Most Bright Idea</span>
											</div>
										</div>
										<div class="col-md-3 col-sm-6" style="margin: 0 50px;">
											<div class="award-item">
												<div class="hexagon">
													<span class="lnr lnr-magic-wand award-icon"></span>
												</div>
												<span>Problem Solver</span>
											</div>
										</div>
										<div class="col-md-3 col-sm-6">
											<div class="award-item">
												<div class="hexagon">
													<span class="lnr lnr-heart award-icon"></span>
												</div>
												<span>Most Loved</span>
											</div>
										</div>
									</div>
								</div>
								<div class="custom-tabs-line tabs-line-bottom left-aligned">
									<ul class="nav" role="tablist">
										<li class="active"><a href="#tab-bottom-left1" role="tab" data-toggle="tab">修改密码</a></li>
										<li><a href="#tab-bottom-left2" role="tab" data-toggle="tab">修改手机号 </a></li>
									</ul>
								</div>
								<div class="tab-content">
									<div class="tab-pane fade in active" id="tab-bottom-left1">
										<ul class="list-unstyled activity-timeline" style="margin-top: 40px; margin-left: 40px;">
								<!--修改密码--><li>
												<i class="fa fa-comment activity-icon"></i>
												<p>&nbsp; 请 输 入 原 密 码  ： <input type="text" id="pw"></p>
											</li>
											<li>
												<i class="fa fa-cloud-upload activity-icon"></i>
												<p>&nbsp; 请 输 入 新 密 码  ： <input type="text" id="pwd" ></p>
											</li>
										</ul>
										<div class="margin-top-30 text-center">
											<a @click="change()" class="btn btn-primary">确认修改</a>
										</div>
									</div>
									<div class="tab-pane fade" id="tab-bottom-left2">
										<ul class="list-unstyled activity-timeline" style="margin-top: 40px; margin-left: 40px;">
							  <!--修改手机号--><li>
												<i class="fa fa-comment activity-icon"></i>
												<p>&nbsp; 输 入 原 手 机 号  ： <input type="text" id="phone">&nbsp;&nbsp;&nbsp;<button @click="gett()">获取验证码</button></p>
											</li>
											<li>
												<i class="fa fa-comment activity-icon"></i>
												<p>&nbsp; 请 输 入 验 证 码 ： <input type="text" id="code" ></p>
											</li>
											<li>
												<i class="fa fa-cloud-upload activity-icon"></i>
												<p>&nbsp; 输 入 新 手 机 号  ： <input type="text" id="nphone" ></p>
											</li>
										</ul>
										<div class="margin-top-30 text-center">
											<a @click="phone()" class="btn btn-primary">确认修改</a>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="clearfix"></div>
		<footer>
			<div class="container-fluid">
				<p class="copyright">Copyright &copy; 2017.Company name All rights reserved.More Templates  - Collect from</p>
			</div>
		</footer>
	</div>
	</div>
	<script src="assets/vendor/jquery/jquery.min.js"></script>
	<script type="text/javascript" src="assets/layui/layui.all.js" ></script>
	<script src="assets/vendor/bootstrap/js/bootstrap.min.js"></script>
	<script src="assets/vendor/jquery-slimscroll/jquery.slimscroll.min.js"></script>
	<script src="assets/scripts/klorofil-common.js"></script>
	<script src="assets/js/vue.js"></script>
	<script src="assets/js/axios.min.js"></script>
	<script type="text/javascript">
		$(function(){
			$("#toping").load("top.html");
		})
		
		var vm = new Vue({
					el:"#app",
					data:{
						mes:{},
						gender:{},
						authority:{},
						shabi:{}
					},
					created(){
						axios.get("http://myzuul.com:9500/user/user/findById").then(res=>{
							this.mes=res.data
							this.gender=res.data.gender
							this.authority=res.data.authority
							
						}).catch(),
						axios.post("http://myzuul.com:9500/user/user/username").then(res=>{
							this.shabi=res.data.authority.id;

						})
						
					},
					methods :{
						change:function(){
							var pw = $("#pw").val();
							var pwd = $("#pwd").val();
							axios.post("http://myzuul.com:9500/user/user/updatePassword?password="+pw+"&repassword="+pwd)
							.then(res=>{

								if(res.data==2){
									layer.msg('密码输入错误 ', {
										icon: 5,
										time: 1500
									}, function(){
										
									});   
								}else if(res.data==1){
									layer.msg('登陆成功', {
										icon: 1,
										time: 500
									}, function(){
										location.href="index.html"
									});   
								}else if(res.data==3){
									layer.msg('格式不正确', {
										icon: 5,
										time: 1500
									}, function(){
									});   
								}
							}).catch();
						},
						gett:function(){
							var phone = $("#phone").val();
							if(phone==""){
								layer.msg('请输入手机号', {
									icon: 7,
									time: 1500
								}, function(){
								});
							}else{
								axios.get("http://myzuul.com:9500/user/member/send?phone="+phone).then(res=>{
									
								}).catch();
							}
						},
						phone:function(){
							var code = $("#code").val();
							var np=$("#nphone").val();
							axios.put("http://myzuul.com:9500/user/user/updatePhone?code="+code+"&phone="+np).
							then(res=>{
								
								if(res.data==1){
									layer.msg('修改成功  ', {
										icon: 1,
										time: 1500
									}, function(){
										window.location.reload();
									});   
								}else if(res.data==2){
									layer.msg('修改失败', {
										icon: 5,
										time: 500
									}, function(){
										
									});   
								}
								
							});
						}
					}
				})
		
		
	</script>
</body>
</html>
